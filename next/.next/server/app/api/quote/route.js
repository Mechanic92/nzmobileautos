(()=>{var e={};e.id=7026,e.ids=[3374,7026],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},38639:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>P,routeModule:()=>m,serverHooks:()=>R,workAsyncStorage:()=>E,workUnitAsyncStorage:()=>I});var s={};r.r(s),r.d(s,{POST:()=>l});var a=r(47268),i=r(61657),n=r(52624),o=r(88125),u=r(93374);let d={BASIC:{PETROL:{CAR:275,SUV:295,PERFORMANCE:345},DIESEL:{UTE:305,COMMERCIAL:345}},COMPREHENSIVE:{PETROL:{CAR:385,SUV:405,PERFORMANCE:465},DIESEL:{UTE:415,COMMERCIAL:465}},DIAGNOSTICS:140,PPI:220};var c=r(35524);let p=c.Ik({plate:c.Yj(),email:c.Yj().email(),serviceMode:c.k5(["SERVICE","REPAIR"]),serviceKey:c.Yj().optional(),classification:c.bz()});async function l(e){try{let t=await e.json(),r=p.safeParse(t);if(!r.success)return o.NextResponse.json({error:"Invalid input"},{status:400});let{plate:s,email:a,serviceMode:i,serviceKey:n,classification:c}=r.data,l=function(e,t,r){if("SERVICE"===e){let e=0;return"DIAGNOSTICS"===r?e=d.DIAGNOSTICS:"PPI"===r?e=d.PPI:(e=function(e,t,r){let s=d[e],a=s[t]||s.PETROL;return a[r]||a.CAR||295}("COMPREHENSIVE"===r?"COMPREHENSIVE":"BASIC","EV"===t.fuel_class?"PETROL":t.fuel_class,t.body_class),t.body_class),{mode:"SERVICE",total:e,gst:.130435*e,breakdown:{base_price:e,oil_included:"Up to 5L included"},disclaimer:"Final oil quantity and requirements confirmed onsite. Extra oil charged at $22/L.",isEstimate:!1}}let s="HEAVY"===t.load_class?{min:450,max:750}:{min:250,max:550};return{mode:"REPAIR",total:s.min,gst:.130435*s.min,estimateRange:s,breakdown:{},disclaimer:"Pricing shown is an estimated range for a standard repair. Final cost depends on parts and complexity, confirmed after diagnostic inspection.",isEstimate:!0}}(i,c,n),m=await u.prisma.customer.findFirst({where:{email:a}});m||(m=await u.prisma.customer.create({data:{publicId:Math.random().toString(36).substring(7),fullName:"Lead from Quote",email:a}}));let E=await u.prisma.vehicle.findFirst({where:{plate:s.toUpperCase()}}),I="SERVICING";"DIAGNOSTICS"===n&&(I="OTHER"),"PPI"===n&&(I="OTHER");let R=crypto.randomUUID();return await u.prisma.quoteRequest.create({data:{publicId:R,status:"NEW",category:I,urgency:"FLEXIBLE",customerId:m.id,vehicleId:E?.id,symptoms:{serviceKey:n},pricingSnapshotJson:l}}),o.NextResponse.json({id:R})}catch(e){return console.error("[Quote POST Error]:",e.message),o.NextResponse.json({error:"Internal Error"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/quote/route",pathname:"/api/quote",filename:"route",bundlePath:"app/api/quote/route"},resolvedPagePath:"C:\\nzmobileautos\\next\\src\\app\\api\\quote\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:E,workUnitAsyncStorage:I,serverHooks:R}=m;function P(){return(0,n.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:I})}},42167:()=>{},95311:()=>{},93374:(e,t,r)=>{"use strict";r.d(t,{prisma:()=>a});var s=r(96330);let a=global.__prisma||new s.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4762,7560,5524],()=>r(38639));module.exports=s})();