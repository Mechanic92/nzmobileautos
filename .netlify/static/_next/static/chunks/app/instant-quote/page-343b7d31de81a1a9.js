(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1357],{2423:(e,t,r)=>{Promise.resolve().then(r.bind(r,1655))},7401:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var s=r(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:o="",children:c,iconNode:u,...x}=e;return(0,s.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:r,strokeWidth:d?24*Number(l)/Number(a):l,className:i("lucide",o),...x},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),d=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{className:d,...o}=r;return(0,s.createElement)(l,{ref:n,iconNode:t,className:i("lucide-".concat(a(e)),d),...o})});return r.displayName="".concat(e),r}},4505:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(7401).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6046:(e,t,r)=>{"use strict";var s=r(6658);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},1655:(e,t,r)=>{"use strict";r.d(t,{default:()=>O});var s=r(5155),a=r(2115),i=r(6046),n=r(7401);let l=(0,n.A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),d=(0,n.A)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),o=(0,n.A)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var c=r(4505);let u=(0,n.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function x(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")}let m={primary:"bg-primary text-primaryText hover:bg-primary/90 border border-primary/20",secondary:"bg-transparent text-primary border border-primary/60 hover:border-primary hover:bg-primary/10",ghost:"bg-transparent text-text border border-transparent hover:bg-white/5 hover:border-border",danger:"bg-danger text-white hover:bg-danger/90 border border-danger/30"},h=a.forwardRef(function(e,t){let{className:r,variant:a="primary",size:i="md",type:n="button",...l}=e;return(0,s.jsx)("button",{ref:t,type:n,className:x("inline-flex items-center justify-center gap-2 rounded-xl font-semibold tracking-tight transition-colors disabled:opacity-50 disabled:pointer-events-none",m[a],"lg"===i?"py-3 px-5 text-base":"sm"===i?"h-9 px-3 text-sm":"h-11 px-4 text-sm",r),...l})});function p(e){let{className:t,...r}=e;return(0,s.jsx)("div",{className:x("rounded-2xl border border-border bg-surface shadow-[0_10px_30px_rgba(0,0,0,0.35)]",t),...r})}function b(e){let{className:t,...r}=e;return(0,s.jsx)("div",{className:x("p-6 pb-0",t),...r})}function y(e){let{className:t,...r}=e;return(0,s.jsx)("div",{className:x("p-6",t),...r})}function f(e){let{className:t,...r}=e;return(0,s.jsx)("h3",{className:x("text-lg font-semibold text-text",t),...r})}function v(e){let{className:t,...r}=e;return(0,s.jsx)("p",{className:x("text-sm text-muted",t),...r})}let g=a.forwardRef(function(e,t){let{className:r,type:a="text",...i}=e;return(0,s.jsx)("input",{ref:t,type:a,className:x("h-11 w-full rounded-xl border border-border bg-surface2 px-4 text-text placeholder:text-muted/70 outline-none transition-colors focus:border-primary/70 focus:ring-1 focus:ring-primary",r),...i})}),j=a.forwardRef(function(e,t){let{className:r,options:a,...i}=e;return(0,s.jsx)("select",{ref:t,className:x("h-11 w-full rounded-xl border border-border bg-surface2 px-4 text-text outline-none transition-colors focus:border-primary/70 focus:ring-1 focus:ring-primary",r),...i,children:a.map(e=>(0,s.jsx)("option",{value:e.value,disabled:e.disabled,children:e.label},e.value))})}),N={default:"border-border bg-surface2 text-text",muted:"border-border bg-surface text-muted",success:"border-success/30 bg-success/10 text-success",danger:"border-danger/30 bg-danger/10 text-danger"};function w(e){let{className:t,variant:r="default",...a}=e;return(0,s.jsx)("span",{className:x("inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-widest",N[r],t),...a})}let k={default:"border-border bg-surface2 text-text",success:"border-success/30 bg-success/10 text-text",danger:"border-danger/30 bg-danger/10 text-text"};function I(e){let{className:t,variant:r="default",...a}=e;return(0,s.jsx)("div",{role:"alert",className:x("rounded-xl border p-4",k[r],t),...a})}function S(e){let{className:t,...r}=e;return(0,s.jsx)("h5",{className:x("text-sm font-semibold",t),...r})}function C(e){let{className:t,...r}=e;return(0,s.jsx)("p",{className:x("mt-1 text-sm text-muted",t),...r})}function A(e){let{label:t,value:r,className:a}=e;return(0,s.jsxs)("div",{className:x("flex items-start justify-between gap-4 text-sm",a),children:[(0,s.jsx)("div",{className:"text-muted",children:t}),(0,s.jsx)("div",{className:"text-text font-semibold text-right",children:r})]})}function E(e){return new Intl.NumberFormat("en-NZ",{style:"currency",currency:"NZD"}).format(e/100)}function O(){var e;let t=(0,i.useRouter)(),[r,n]=(0,a.useState)(""),[x,m]=(0,a.useState)("DIAGNOSTICS"),[N,k]=(0,a.useState)(!1),[O,q]=(0,a.useState)(null),[P,R]=(0,a.useState)(null),[T,_]=(0,a.useState)(null),V=(0,a.useMemo)(()=>[{value:"DIAGNOSTICS",label:"Diagnostics ($140 fixed)"},{value:"PPI",label:"Pre-Purchase Inspection ($180 fixed)"},{value:"SERVICE",label:"Service / Repair (banded estimate)"}],[]),M=async()=>{k(!0),q(null),R(null),_(null);try{let e=r.trim();if(!e)throw Error("Enter a plate or VIN");let t=await fetch("/api/identity",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({plateOrVin:e})}),s=await t.json();if(!t.ok)throw Error((null==s?void 0:s.error)||"Identity lookup failed");R(s);let a=await fetch("/api/quote",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({vehicleIdentity:s.vehicleIdentity,intent:x})}),i=await a.json();if(!a.ok)throw Error((null==i?void 0:i.error)||"Quote generation failed");_(i)}catch(e){q((null==e?void 0:e.message)||"Something went wrong")}finally{k(!1)}},D=!!(null==T?void 0:T.quoteId)&&!(null==T?void 0:null===(e=T.pricingSnapshot)||void 0===e?void 0:e.isEstimateOnly);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(p,{children:[(0,s.jsxs)(b,{children:[(0,s.jsx)(f,{children:"Instant quote"}),(0,s.jsx)(v,{children:"Plate/VIN → identity → service classification → bounded price. We do not overpromise—assumptions are shown below."})]}),(0,s.jsxs)(y,{className:"space-y-4",children:[O&&(0,s.jsxs)(I,{variant:"danger",children:[(0,s.jsx)(S,{children:"Couldn’t generate quote"}),(0,s.jsx)(C,{children:O})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-widest text-muted",children:"Plate or VIN"}),(0,s.jsx)(g,{value:r,onChange:e=>n(e.target.value.toUpperCase()),placeholder:"ABC123 or VIN"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-widest text-muted",children:"Service intent"}),(0,s.jsx)(j,{value:x,onChange:e=>m(e.target.value),options:V})]})]}),(0,s.jsx)(h,{variant:"primary",size:"lg",onClick:M,disabled:N,className:"w-full",children:N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{className:"h-5 w-5 animate-spin"}),"Processing…"]}):"Get quote"}),(0,s.jsx)("div",{className:"grid gap-3 md:grid-cols-3",children:[{icon:l,label:"Secure payment (Stripe)"},{icon:d,label:"Instant confirmation"},{icon:o,label:"Afterpay available"}].map(e=>(0,s.jsxs)("div",{className:"rounded-xl border border-border bg-surface2 px-4 py-3 flex items-center gap-3",children:[(0,s.jsx)(e.icon,{className:"h-5 w-5 text-primary"}),(0,s.jsx)("div",{className:"text-sm text-muted",children:e.label})]},e.label))}),(0,s.jsx)("div",{className:"text-xs text-muted",children:"No WOF inspections. This tool provides pricing bounds based on MotorWeb identity and your chosen service intent."})]})]}),P&&(0,s.jsxs)(p,{children:[(0,s.jsx)(b,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(f,{children:"Vehicle identity"}),(0,s.jsxs)(v,{children:["MotorWeb identity lookup (server-only mTLS). Cache: ",P.cacheHit?"HIT":"MISS","."]})]}),(0,s.jsx)(w,{variant:P.cacheHit?"muted":"default",children:P.cacheHit?"CACHE":"MOTORWEB"})]})}),(0,s.jsxs)(y,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"text-xl font-semibold",children:[P.vehicleIdentity.year," ",P.vehicleIdentity.make," ",P.vehicleIdentity.model]}),(0,s.jsxs)("div",{className:"text-sm text-muted",children:[P.vehicleIdentity.plate||r.toUpperCase()," • ",P.vehicleIdentity.vin||"VIN unavailable"]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(w,{variant:"muted",children:P.vehicleIdentity.fuel||"Fuel unknown"}),(0,s.jsx)(w,{variant:"muted",children:P.vehicleIdentity.body_style||"Body unknown"}),(0,s.jsx)(w,{variant:"muted",children:P.vehicleIdentity.power_kw?"".concat(P.vehicleIdentity.power_kw,"kW"):"Power unknown"})]})]})]}),T&&(0,s.jsxs)(p,{children:[(0,s.jsx)(b,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(f,{children:"Quote summary"}),(0,s.jsx)(v,{children:"Bounded pricing snapshot saved for booking step 2."})]}),T.pricingSnapshot.isEstimateOnly?(0,s.jsx)(w,{variant:"danger",children:"ESTIMATE ONLY"}):(0,s.jsx)(w,{variant:"success",children:"FIXED / BANDED"})]})}),(0,s.jsxs)(y,{className:"space-y-4",children:[T.pricingSnapshot.isEstimateOnly?(0,s.jsxs)(I,{children:[(0,s.jsx)(S,{children:"Estimate request"}),(0,s.jsx)(C,{children:"General repair pricing requires diagnosis. Use Diagnostics for a fixed booking, or submit a quote request."})]}):(0,s.jsxs)("div",{className:"rounded-xl border border-border bg-surface2 p-4 space-y-2",children:[T.pricingSnapshot.lines.map(e=>(0,s.jsx)(A,{label:e.label,value:E(e.amountCents)},e.key)),(0,s.jsx)("div",{className:"h-px bg-border"}),(0,s.jsx)(A,{label:(0,s.jsx)("span",{className:"text-text",children:"Total (inc GST)"}),value:(0,s.jsx)("span",{className:"text-primary",children:E(T.pricingSnapshot.totalIncGstCents||0)})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-widest text-muted",children:"Assumptions & disclaimers"}),(0,s.jsx)("div",{className:"space-y-2",children:T.disclaimers.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start gap-2 text-sm text-muted",children:[(0,s.jsx)(u,{className:"h-4 w-4 text-primary mt-0.5"}),(0,s.jsx)("div",{children:e})]},t))})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsx)(h,{variant:"secondary",onClick:()=>{R(null),_(null),n(""),q(null)},children:"Start over"}),D?(0,s.jsx)(h,{variant:"primary",onClick:()=>t.push("/book?quoteId=".concat(encodeURIComponent(T.quoteId))),children:"Continue to booking"}):(0,s.jsx)(h,{variant:"secondary",onClick:()=>t.push("/book/quote"),children:"Request a quote"})]})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1517,7358],()=>t(2423)),_N_E=e.O()}]);